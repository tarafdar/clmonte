CLSOURCES=$(CLDIR)/CLMonte.cpp
CUDASOURCES=$(CUDADIR)/CUDAMC.cu
CLOUT=CLMonte
CUDAOUT=CUDAMC
CLFLAGS =-O3 -o
CUDAFLAGS=-O3 -o
CLLIB=-l OpenCL
CUDAARCH=-arch=sm_11
SRCDIR=SRC
CUDADIR=$(SRCDIR)/CUDA_SRC
CLDIR=$(SRCDIR)/CLMonte_SRC
CLDIR_UNITTESTS=$(SRCDIR)/CLMonte_SRC/UnitTests
UNITTEST_REFLECT = reflectUT
UTSOURCES=$(CLDIR_UNITTESTS)/CLMonteBenchmark.cpp

all: $(CLOUT) $(CUDAOUT)

$(CLOUT): $(CLDIR)/CLMonte.cpp $(CLDIR)/CLMonteTransport.cl $(CLDIR)/CLMonte_goldstandard.c
	g++ $(CLSOURCES) $(CLFLAGS) $(CLOUT) $(CLLIB)

$(CUDAOUT): $(CUDADIR)/CUDAMC.cu $(CUDADIR)/CUDAMCtransport.cu $(CUDADIR)/CUDAMC_goldstandard.c
	nvcc $(CUDAARCH)  $(CUDASOURCES) $(CUDAFLAGS) $(CUDAOUT)

$(UNITTEST_REFLECT): $(CLDIR_UNITTESTS)/CLMonteBenchmark.cpp $(CLDIR_UNITTESTS)/CLMonteBenchmark_reflect.cl
	g++ $(UTSOURCES) $(CLFLAGS) $(UNITTEST_REFLECT) $(CLLIB)

clean:
	rm -rf *.txt $(CLOUT) $(CUDAOUT) $(UNITTEST_REFLECT)
